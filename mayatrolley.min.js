function shadeColor(a,b){var c=parseInt(a.slice(1),16),d=Math.round(2.55*b),e=(c>>16)+d,f=(c>>8&255)+d,g=(255&c)+d;return"#"+(16777216+65536*(255>e?1>e?0:e:255)+256*(255>f?1>f?0:f:255)+(255>g?1>g?0:g:255)).toString(16).slice(1)}function createMap(){return L.map("map",{center:DEFAULTS.CENTER,zoom:DEFAULTS.ZOOM})}function tileLayer(){var a="https://{s}.tiles.mapbox.com/v3/vramirez122000.kc4acpgn/{z}/{x}/{y}.png";return L.tileLayer(a,{minZoom:DEFAULTS.MIN_ZOOM,maxZoom:DEFAULTS.MAX_ZOOM,maxBounds:DEFAULTS.BOUNDS,attribution:'<a href="http://www.openstreetmap.org/" target="_blank">OpenStreetMap Contributors</a>'})}function getAllRoutes(a){$.ajax("rutas.geojson",{contentType:"application/json; charset=UTF-8",dataType:"json",success:function(b){for(var c=0;c<b.features.length;c++){var d=b.features[c],e=L.geoJson(d,{style:routeStyle,onEachFeature:onEachRoute});a.routeLayers[d.id]=e;var f=d.properties.color,g=shadeColor(d.properties.color,100-100*DEFAULTS.ROUTE_COLOR_OPACITY),h='<span class="routeLabel" style="background-color: '+g+"; text-shadow: -1px 0 "+f+", 0 1px "+f+", 1px 0 "+f+", 0 -1px "+f+"; border-color: "+f+'">'+d.properties.nombre+"</span>";e.addTo(a.map),a.layerControl.addOverlay(e,h)}a.markerGroup.getLayers().length&&a.markerGroup.bringToFront(),a.map.locate({setView:!0,maxZoom:13,enableHighAccuracy:!0})}})}function getPoints(a){$.ajax("puntos.geojson",{contentType:"application/json; charset=UTF-8",dataType:"json",success:function(b){for(var c=0;c<b.features.length;c++){var d=b.features[c],e=L.circleMarker(d.geometry.coordinates.reverse(),{color:"#333333",fillColor:"#ffffff",fillOpacity:9,radius:"5"});a.markerGroup.addLayer(e)}a.markerGroup.addTo(a.map)}})}function routeStyle(a){return{weight:6,opacity:DEFAULTS.ROUTE_COLOR_OPACITY,color:a.properties.color}}function onEachRoute(a,b){b.bindPopup(a.properties.nombre),b.on("click",function(){b.bringToFront(),markerGroup.bringToFront()})}var DEFAULTS={CENTER:[18.2011,-67.1396],ZOOM:13,MIN_ZOOM:10,MAX_ZOOM:19,BOUNDS:[[18.352687,-66.179752],[18.477284,-65.928097]],ROUTE_COLOR_OPACITY:.65};